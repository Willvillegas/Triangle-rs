use triangle_rs::scanner::*;

#[test]
fn test_sourcefile() {
    let mut source_file = SourceFile::new("samples/source/odd_degenerate.t");
    while let Some(c) = source_file.next() {
        println!("{:?}", c);
    }
}

#[test]
fn test_emptycommandeot() {
    let source_file = "samples/source/emptycommandeot.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![Token::new(
        TokenType::Eot,
        NULL_STR,
        SourcePosition::default(),
    )];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_emptycommandeot_degenerate() {
    let source_file = "samples/source/emptycommandeot_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![Token::new(
        TokenType::Eot,
        NULL_STR,
        SourcePosition::default(),
    )];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_emptycommandsemicolon() {
    let source_file = "samples/source/emptycommandsemicolon.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_emptycommandsemicolon_degenerate() {
    let source_file = "samples/source/emptycommandsemicolon_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_hello() {
    let source_file = "samples/source/hello.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "42", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_hello_degenerate() {
    let source_file = "samples/source/hello_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "42", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_inc() {
    let source_file = "samples/source/inc.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "inc", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "inc", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_inc_degenerate() {
    let source_file = "samples/source/inc_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "inc", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "inc", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_echo() {
    let source_file = "samples/source/echo.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "echo", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Identifier, "echo", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_echo_degenerate() {
    let source_file = "samples/source/echo_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "echo", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Identifier, "echo", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_odd() {
    let source_file = "samples/source/odd.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(TokenType::Identifier, "odd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Boolean", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "2", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "odd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "2", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_odd_degenerate() {
    let source_file = "samples/source/odd_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(TokenType::Identifier, "odd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Boolean", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "2", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "odd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "2", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_sum_proc() {
    let source_file = "samples/source/sum_proc.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "add", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "add", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_sum_proc_degenerate() {
    let source_file = "samples/source/sum_proc_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "add", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "add", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_power() {
    let source_file = "samples/source/power.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(TokenType::Identifier, "power", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "power", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "power", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_power_degenerate() {
    let source_file = "samples/source/power_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases: Vec<Token> = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(TokenType::Identifier, "power", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "power", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "power", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_factorial() {
    let source_file = "samples/source/factorial.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "factorial",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "<=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "factorial",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readnumber",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readnumber",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "factorial",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_factorial_degenerate() {
    let source_file = "samples/source/factorial_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "factorial",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "<=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "factorial",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readnumber",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readnumber",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "factorial",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_record() {
    let source_file = "samples/source/record.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "2021", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_record_degenerate() {
    let source_file = "samples/source/record_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "2021", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "today", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "tomorrow", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_leapyear() {
    let source_file = "samples/source/leapyear.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases: Vec<Token> = vec![];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_leapyear_degenerate() {
    let source_file = "samples/source/leapyear_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases: Vec<Token> = vec![];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_date() {
    let source_file = "samples/source/date.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_date_degenerate() {
    let source_file = "samples/source/date_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_print_array() {
    let source_file = "samples/source/print_array.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "println", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "iterate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "f", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "f", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "100", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "iterate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "println", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_print_array_degnerate() {
    let source_file = "samples/source/print_array_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "println", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "iterate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "f", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "f", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "100", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "iterate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "println", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_string() {
    let source_file = "samples/source/string.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "String", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "buf", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "100", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "String", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "buf", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readstring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "String", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "buf", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "String", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readstring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_string_degenerate() {
    let source_file = "samples/source/string_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "String", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "buf", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "100", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "String", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "buf", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readstring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "String", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "buf", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "String", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readstring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_reverse_line() {
    let source_file = "samples/source/reverse_line.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "80", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "geteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "putreversedline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, ">", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eof", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "putreversedline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_reverse_line_degenerate() {
    let source_file = "samples/source/reverse_line_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "80", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "geteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "putreversedline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, ">", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eof", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "putreversedline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_iteratively() {
    let source_file = "samples/source/iteratively.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "iteratively",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readnums", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putintln", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readnums", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "iteratively",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "iteratively",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putintln", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_iteratively_degenerate() {
    let source_file = "samples/source/iteratively_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "iteratively",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readnums", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putintln", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readnums", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "iteratively",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "iteratively",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putintln", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_line() {
    let source_file = "samples/source/line.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "80", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "putreversedline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, ">=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "putreversedline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_line_degenerate() {
    let source_file = "samples/source/line_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "80", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "putreversedline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "length", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, ">=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "l", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "content", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Line", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putline", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "putreversedline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "currentline",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_dates() {
    let source_file = "samples/source/dates.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "xmas", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "25", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "easter", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "holidays", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "-", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readdates",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "easter", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readdates",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "holidays", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "xmas", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "easter", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "holidays", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "holidays", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_dates_degenerate() {
    let source_file = "samples/source/dates_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "xmas", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "25", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "easter", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "holidays", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "-", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readdates",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "easter", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readdates",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "holidays", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "xmas", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "easter", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "holidays", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaydate",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "holidays", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_monthsofyear() {
    let source_file = "samples/source/monthsofyear.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "months", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "printmonths",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(TokenType::Identifier, "leap", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Boolean", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "100", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "/\\", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "400", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\/", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "4", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "true", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "false", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "getmonths",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "leap", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "29", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "28", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "30", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "30", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "30", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "30", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "getmonths",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "printmonths",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_monthsofyear_degenerate() {
    let source_file = "samples/source/monthsofyear_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases: Vec<Token> = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "months", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "printmonths",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(TokenType::Identifier, "leap", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Boolean", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "100", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "/\\", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "400", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\/", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "4", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "true", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "false", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "getmonths",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "leap", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "29", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "28", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "30", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "30", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "30", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "30", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "31", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readdate", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "getmonths",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "printmonths",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ms", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_capitalise() {
    let source_file = "samples/source/capitalise.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "shift", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "A", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "capitalisechar",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, ">=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "/\\", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "<=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "z", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "chr", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::Identifier, "shift", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "capitalise",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "capitalisechar",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readstring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readstring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "capitalise",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_capitalise_degenerate() {
    let source_file = "samples/source/capitalise_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "shift", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "A", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "capitalisechar",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, ">=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "/\\", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "<=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "z", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "chr", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::Identifier, "shift", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "capitalise",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "capitalisechar",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readstring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "5", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readstring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "capitalise",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaystring",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_freq() {
    let source_file = "samples/source/freq.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases: Vec<Token> = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "initialize",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "increment",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, ">=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "/\\", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "<=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "z", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "calculatefreqs",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "increment",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayfreqs",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "chr", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "=", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, ">", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "initialize",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "calculatefreqs",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayfreqs",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_freq_degenerate() {
    let source_file = "samples/source/freq_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases: Vec<Token> = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "initialize",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "arr", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "increment",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, ">=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "/\\", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "<=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "z", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "calculatefreqs",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Operator, "\\", SourcePosition::default()),
        Token::new(TokenType::Identifier, "eol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "get", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "increment",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ch", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayfreqs",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "chr", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "ord", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "=", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, ">", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "26", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "initialize",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "calculatefreqs",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayfreqs",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "freq", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_insertion_sort() {
    let source_file = "samples/source/insertion_sort.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readNumsSub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readNumsSub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readNums", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readNumsSub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaySub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaySub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "display", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaySub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "insertionSort",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "key", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "key", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, ">=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "/\\", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, ">", SourcePosition::default()),
        Token::new(TokenType::Identifier, "key", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "key", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readNums", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "display", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "insertionSort",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "display", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_insertion_sort_degenerate() {
    let source_file = "samples/source/insertion_sort_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readNumsSub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readNumsSub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readNums", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readNumsSub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaySub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaySub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "idx", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "stop", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(TokenType::Identifier, "display", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaySub",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "insertionSort",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "key", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "10", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "key", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, ">=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "/\\", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, ">", SourcePosition::default()),
        Token::new(TokenType::Identifier, "key", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "key", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "readNums", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "display", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "insertionSort",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "display", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "s", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_rationals() {
    let source_file = "samples/source/rationals.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(TokenType::Identifier, "gcd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "gcd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "makerational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "g", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "gcd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "/", SourcePosition::default()),
        Token::new(TokenType::Identifier, "g", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Operator, "/", SourcePosition::default()),
        Token::new(TokenType::Identifier, "g", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "makerational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "{", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, ",", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "}", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "addrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "num", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "denom", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "makerational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "num", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "denom", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "subrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "num", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "denom", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "makerational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "num", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "denom", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "addrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "subrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_rationals_degenerate() {
    let source_file = "samples/source/rationals_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(TokenType::Identifier, "gcd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "gcd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Operator, "//", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "makerational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "g", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "gcd", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "n", SourcePosition::default()),
        Token::new(TokenType::Operator, "/", SourcePosition::default()),
        Token::new(TokenType::Identifier, "g", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Operator, "/", SourcePosition::default()),
        Token::new(TokenType::Identifier, "g", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "makerational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "{", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, ",", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "}", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "addrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "num", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "denom", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "makerational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "num", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "denom", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Function, "func", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "subrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "num", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Operator, "-", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "numerator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Const, "const", SourcePosition::default()),
        Token::new(TokenType::Identifier, "denom", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r1", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::Operator, "*", SourcePosition::default()),
        Token::new(TokenType::Identifier, "r2", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "denominator",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "makerational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "num", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "denom", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Rational", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "readrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "addrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "subrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "a", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayrational",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "c", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_eqnoteq() {
    let source_file = "samples/source/eqnoteq.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "2", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_eqnoteq_degenerate() {
    let source_file = "samples/source/eqnoteq_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "x", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "2", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_nestedarrays() {
    let source_file = "samples/source/nestedarrays.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Matrix", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "4", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "mat", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Matrix", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayprompt",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "E", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "t", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "e", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "r", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "u", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "e", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "r", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, ":", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "initialisematrix",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Matrix", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "4", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayprompt",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaymatrix",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Matrix", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "4", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "initialisematrix",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "mat", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaymatrix",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "mat", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_nestedarrays_degenerate() {
    let source_file = "samples/source/nestedarrays_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Matrix", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Array, "array", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "4", SourcePosition::default()),
        Token::new(TokenType::Of, "of", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "mat", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Matrix", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayprompt",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "E", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "t", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "e", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "r", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "u", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "b", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "e", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "r", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, ":", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "initialisematrix",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Matrix", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "4", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayprompt",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "getint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaymatrix",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Matrix", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "3", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "0", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::While, "while", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "<", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "4", SourcePosition::default()),
        Token::new(TokenType::Do, "do", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftSquareBracket, "[", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(
            TokenType::RightSquareBracket,
            "]",
            SourcePosition::default(),
        ),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "j", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "i", SourcePosition::default()),
        Token::new(TokenType::Operator, "+", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "initialisematrix",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "mat", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displaymatrix",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "mat", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_nestedrecords() {
    let source_file = "samples/source/nestedrecords.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Person", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "initials", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "married", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Boolean", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayperson",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Person", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "initials", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "married", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "true", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "bob", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Person", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "bob", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "initials", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "B", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "married", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "false", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1970", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "22", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayperson",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "bob", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}

#[test]
fn test_nestedrecords_degenerate() {
    let source_file = "samples/source/nestedrecords_degenerate.t";
    let mut scanner = Scanner::new(source_file);
    let test_cases = vec![
        Token::new(TokenType::Let, "let", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Integer", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Type, "type", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Person", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Record, "record", SourcePosition::default()),
        Token::new(TokenType::Identifier, "initials", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Char", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "married", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Boolean", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Date", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Procedure, "proc", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayperson",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Person", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "initials", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::If, "if", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "married", SourcePosition::default()),
        Token::new(TokenType::Operator, "=", SourcePosition::default()),
        Token::new(TokenType::Identifier, "true", SourcePosition::default()),
        Token::new(TokenType::Then, "then", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Else, "else", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "n", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "puteol", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "putint", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "p", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Dot, ".", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Identifier, "put", SourcePosition::default()),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, " ", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(TokenType::Var, "var", SourcePosition::default()),
        Token::new(TokenType::Identifier, "bob", SourcePosition::default()),
        Token::new(TokenType::Colon, ":", SourcePosition::default()),
        Token::new(TokenType::Identifier, "Person", SourcePosition::default()),
        Token::new(TokenType::In, "in", SourcePosition::default()),
        Token::new(TokenType::Begin, "begin", SourcePosition::default()),
        Token::new(TokenType::Identifier, "bob", SourcePosition::default()),
        Token::new(TokenType::Becomes, ":=", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "initials", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::CharacterLiteral, "B", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "married", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::Identifier, "false", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "dob", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::LeftCurlyBracket, "{", SourcePosition::default()),
        Token::new(TokenType::Identifier, "y", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "1970", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "m", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "12", SourcePosition::default()),
        Token::new(TokenType::Comma, ",", SourcePosition::default()),
        Token::new(TokenType::Identifier, "d", SourcePosition::default()),
        Token::new(TokenType::Is, "~", SourcePosition::default()),
        Token::new(TokenType::IntegerLiteral, "22", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::RightCurlyBracket, "}", SourcePosition::default()),
        Token::new(TokenType::Semicolon, ";", SourcePosition::default()),
        Token::new(
            TokenType::Identifier,
            "displayperson",
            SourcePosition::default(),
        ),
        Token::new(TokenType::LeftParen, "(", SourcePosition::default()),
        Token::new(TokenType::Identifier, "bob", SourcePosition::default()),
        Token::new(TokenType::RightParen, ")", SourcePosition::default()),
        Token::new(TokenType::End, "end", SourcePosition::default()),
        Token::new(TokenType::Eot, NULL_STR, SourcePosition::default()),
    ];

    for tt in test_cases {
        let token = scanner.scan_token();
        assert_eq!(tt, token);
    }
}
